from itertools import count
import numpy as np

def main(debug=False):
    toutesConnections = []
    
    positions = []
    with open("day8/input.txt") as f:
        positions = np.array([line.strip().split(',') for line in f])
    
    #if debug: print(f"{positions}\n")
    
    circuits = [[i] for i in range(len(positions))]
    if debug: print(f"{circuits}\n")
    
    # Compute distance matrix
    rows, _ = positions.shape
    distanceMatrix = np.zeros((rows, rows), dtype=int)
    for i in range(1,rows):
        for j in range(i):
            distanceMatrix[i][j] = distance(positions[i], positions[j])
            distanceMatrix[j][i] = distanceMatrix[i][j]
    
    print("Distance matrix computed ")
    for _ in range(1000):
        i, j, toutesConnections = cooMinMatrix(distanceMatrix, toutesConnections)
        distanceMatrix[i][j] = 0
        distanceMatrix[j][i] = 0
    
    print("Toutes les distances calcul√©es")
    
    vraiesConnections = [666, 957, 1133, 1219, 1224, 1255, 1274, 1376, 1521, 1539, 1586, 1690, 1695, 1758, 1769, 2033, 2060, 2142, 2204, 2217, 2282, 2303, 2481, 2482, 2500, 2501, 2581, 2583, 2602, 2620, 2622, 2631, 2651, 2670, 2676, 2697, 2704, 2710, 2757, 2763, 2769, 2772, 2814, 2818, 2832, 2847, 2851, 2869, 2876, 2917, 2918, 3025, 3030, 3067, 3080, 3083, 3092, 3099, 3119, 3134, 3136, 3157, 3158, 3169, 3170, 3191, 3212, 3225, 3234, 3247, 3251, 3272, 3280, 3282, 3293, 3312, 3325, 3364, 3401, 3433, 3439, 3440, 3453, 3487, 3496, 3497, 3525, 3545, 3548, 3549, 3559, 3567, 3578, 3601, 3603, 3605, 3609, 3614, 3618, 3621, 3627, 3628, 3648, 3659, 3664, 3676, 3700, 3730, 3761, 3768, 3802, 3822, 3822, 3842, 3844, 3851, 3855, 3856, 3862, 3883, 3890, 3892, 3893, 3903, 3928, 3936, 3953, 3968, 3978, 3988, 4007, 4007, 4017, 4025, 4041, 4042, 4055, 4071, 4072, 4077, 4125, 4138, 4169, 4169, 4173, 4229, 4230, 4246, 4258, 4262, 4276, 4284, 4293, 4299, 4312, 4314, 4330, 4331, 4339, 4340, 4343, 4348, 4363, 4364, 4374, 4380, 4380, 4386, 4389, 4390, 4433, 4456, 4476, 4483, 4510, 4540, 4557, 4560, 4570, 4594, 4598, 4600, 4606, 4620, 4640, 4649, 4670, 4679, 4679, 4684, 4688, 4710, 4716, 4719, 4739, 4739, 4754, 4757, 4779, 4780, 4794, 4802, 4819, 4821, 4827, 4830, 4831, 4833, 4850, 4851, 4866, 4867, 4885, 4886, 4898, 4899, 4901, 4902, 4918, 4928, 4928, 4933, 4936, 4942, 4943, 4960, 4988, 4992, 4994, 4996, 5002, 5008, 5014, 5019, 5027, 5030, 5049, 5050, 5051, 5069, 5084, 5088, 5121, 5125, 5126, 5151, 5151, 5160, 5183, 5183, 5184, 5211, 5214, 5225, 5225, 5228, 5246, 5250, 5250, 5251, 5261, 5265, 5268, 5283, 5285, 5288, 5289, 5290, 5290, 5319, 5327, 5328, 5329, 5334, 5335, 5348, 5363, 5365, 5371, 5396, 5406, 5406, 5409, 5423, 5424, 5436, 5448, 5453, 5457, 5458, 5460, 5466, 5468, 5469, 5470, 5490, 5492, 5493, 5519, 5526, 5537, 5545, 5546, 5581, 5589, 5593, 5594, 5599, 5614, 5614, 5629, 5631, 5633, 5649, 5652, 5652, 5663, 5664, 5668, 5689, 5692, 5693, 5716, 5725, 5734, 5748, 5750, 5753, 5754, 5754, 5755, 5757, 5760, 5774, 5775, 5780, 5781, 5782, 5786, 5787, 5792, 5793, 5802, 5805, 5807, 5808, 5817, 5826, 5829, 5833, 5843, 5845, 5849, 5860, 5870, 5870, 5871, 5893, 5893, 5896, 5901, 5907, 5928, 5928, 5933, 5941, 5957, 5957, 5964, 5968, 5968, 5973, 5975, 5980, 5980, 5984, 5986, 5992, 5995, 5998, 6004, 6014, 6020, 6021, 6027, 6037, 6042, 6045, 6047, 6063, 6067, 6073, 6084, 6095, 6113, 6115, 6121, 6126, 6134, 6135, 6137, 6141, 6145, 6153, 6153, 6154, 6155, 6166, 6168, 6170, 6177, 6177, 6196, 6207, 6212, 6221, 6226, 6226, 6227, 6236, 6239, 6241, 6241, 6262, 6262, 6267, 6269, 6270, 6272, 6276, 6278, 6278, 6283, 6283, 6284, 6288, 6290, 6290, 6299, 6307, 6309, 6317, 6320, 6321, 6328, 6332, 6333, 6335, 6336, 6341, 6354, 6355, 6355, 6357, 6357, 6362, 6364, 6372, 6385, 6390, 6393, 6398, 6399, 6400, 6406, 6420, 6441, 6457, 6474, 6501, 6505, 6505, 6507, 6509, 6511, 6512, 6515, 6516, 6530, 6537, 6543, 6544, 6545, 6546, 6550, 6550, 6551, 6560, 6560, 6560, 6563, 6576, 6580, 6604, 6605, 6611, 6621, 6634, 6637, 6645, 6648, 6649, 6653, 6655, 6661, 6671, 6674, 6677, 6677, 6679, 6680, 6680, 6682, 6684, 6686, 6691, 6706, 6714, 6715, 6721, 6722, 6747, 6758, 6765, 6771, 6774, 6783, 6785, 6786, 6787, 6788, 6795, 6800, 6805, 6807, 6809, 6810, 6823, 6823, 6833, 6836, 6839, 6846, 6847, 6848, 6848, 6858, 6858, 6870, 6876, 6877, 6879, 6886, 6889, 6895, 6901, 6919, 6923, 6945, 6954, 6968, 6971, 6988, 7016, 7018, 7024, 7025, 7042, 7046, 7052, 7056, 7070, 7070, 7074, 7082, 7088, 7098, 7100, 7117, 7121, 7125, 7130, 7142, 7168, 7173, 7175, 7183, 7196, 7200, 7208, 7237, 7239, 7243, 7247, 7249, 7255, 7256, 7258, 7261, 7262, 7267, 7276, 7285, 7287, 7288, 7294, 7297, 7307, 7310, 7314, 7317, 7327, 7327, 7337, 7345, 7351, 7353, 7358, 7365, 7365, 7372, 7372, 7373, 7374, 7376, 7376, 7377, 7381, 7381, 7399, 7401, 7403, 7411, 7411, 7417, 7418, 7422, 7425, 7426, 7438, 7442, 7442, 7469, 7483, 7483, 7484, 7488, 7490, 7505, 7508, 7509, 7517, 7517, 7519, 7525, 7530, 7535, 7541, 7542, 7544, 7564, 7565, 7565, 7574, 7579, 7581, 7596, 7612, 7613, 7621, 7622, 7629, 7632, 7643, 7644, 7645, 7647, 7650, 7654, 7663, 7674, 7684, 7697, 7703, 7704, 7705, 7706, 7709, 7729, 7731, 7733, 7734, 7735, 7743, 7747, 7751, 7754, 7764, 7768, 7792, 7805, 7806, 7819, 7825, 7828, 7844, 7863, 7876, 7893, 7894, 7897, 7904, 7914, 7920, 7921, 7925, 7929, 7930, 7937, 7946, 7948, 7954, 7956, 7972, 7977, 7980, 7990, 8003, 8006, 8007, 8008, 8012, 8017, 8020, 8024, 8024, 8034, 8049, 8059, 8067, 8074, 8077, 8084, 8088, 8092, 8098, 8103, 8108, 8112, 8115, 8118, 8118, 8120, 8126, 8127, 8127, 8128, 8130, 8148, 8159, 8161, 8170, 8182, 8184, 8189, 8195, 8201, 8202, 8209, 8209, 8214, 8224, 8225, 8230, 8254, 8258, 8263, 8268, 8281, 8293, 8303, 8304, 8311, 8314, 8321, 8326, 8353, 8357, 8384, 8399, 8403, 8415, 8419, 8435, 8436, 8441, 8444, 8461, 8462, 8464, 8489, 8490, 8497, 8508, 8509, 8509, 8518, 8520, 8523, 8529, 8544, 8557, 8565, 8577, 8579, 8581, 8585, 8597, 8602, 8606, 8606, 8617, 8618, 8620, 8621, 8638, 8639, 8641, 8643, 8645, 8655, 8658, 8681, 8693, 8698, 8698, 8702, 8709, 8710, 8721, 8728, 8735, 8741, 8763, 8764, 8769, 8788, 8800, 8800, 8821, 8826, 8829, 8832, 8844, 8857, 8860, 8869, 8880, 8882, 8885, 8891, 8896, 8901, 8919, 8921, 8937, 8943, 8944, 8948, 8967, 8969, 8985, 9002, 9002, 9004, 9009, 9011, 9037, 9044, 9060, 9071, 9078, 9091, 9101, 9110, 9123, 9144, 9149, 9170, 9174, 9184, 9193, 9210, 9222, 9229, 9230, 9241, 9243, 9243, 9248, 9254, 9259, 9281, 9301, 9304, 9311, 9333, 9363, 9380, 9383, 9426, 9433, 9456, 9462, 9469, 9497, 9506, 9509, 9531, 9553, 9564, 9602, 9605, 9614, 9650, 9700, 9715, 9732, 9749, 9774, 9779, 9787, 9800, 9810, 9827, 9830, 9830, 9834, 9838, 9843, 9877, 9938, 9962, 9965, 9974, 9975, 10018, 10035, 10035, 10080, 10118, 10138, 10142, 10154, 10155, 10167, 10197, 10226, 10226, 10314, 10317, 10326, 10376, 10391, 10402, 10408, 10456, 10552, 10556, 10645, 10670, 10674, 10770, 10776, 10784, 10874, 10877, 10881, 10985, 10990, 10996, 10999, 11004, 11045, 11211, 11388, 11451, 11496, 11807, 11849, 12076, 12097, 12276, 12395, 12415, 12439, 12793, 12805, 16539]
    for c in vraiesConnections:
        if c in toutesConnections:
            toutesConnections.remove(c)
            print("removed :" + str(c))
        else:
            print("NOT removed :" + str(c))
    
    lens = len(toutesConnections)
    print(f"Il y a {lens} mauvaises connections:")

        
    
def cooMinMatrix(matrix, toutesConnections):
    minVal = float('inf')
    minPos = [-1, -1]
    rows, _ = matrix.shape
    for i in range(rows):
        for j in range(i):
            if matrix[i][j] < minVal and matrix[i][j] != 0:
                minVal = matrix[i][j]
                minPos = [i, j]
                
    toutesConnections.append(minVal)
    minPos.sort()
    return minPos[0], minPos[1], toutesConnections
    
def distance(pos1, pos2):
    x = (int(pos1[0]) - int(pos2[0]))**2
    y = (int(pos1[1]) - int(pos2[1]))**2
    z = (int(pos1[2]) - int(pos2[2]))**2
    return (x + y + z)**0.5        

if __name__ == '__main__':
    main()